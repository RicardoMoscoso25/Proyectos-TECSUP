<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>93baca69336c43e6b3234ca53313d627</title>
  <style>
    html {
      line-height: 1.5;
      font-family: Georgia, serif;
      font-size: 20px;
      color: #1a1a1a;
      background-color: #fdfdfd;
    }
    body {
      margin: 0 auto;
      max-width: 36em;
      padding-left: 50px;
      padding-right: 50px;
      padding-top: 50px;
      padding-bottom: 50px;
      hyphens: auto;
      overflow-wrap: break-word;
      text-rendering: optimizeLegibility;
      font-kerning: normal;
    }
    @media (max-width: 600px) {
      body {
        font-size: 0.9em;
        padding: 1em;
      }
      h1 {
        font-size: 1.8em;
      }
    }
    @media print {
      body {
        background-color: transparent;
        color: black;
        font-size: 12pt;
      }
      p, h2, h3 {
        orphans: 3;
        widows: 3;
      }
      h2, h3, h4 {
        page-break-after: avoid;
      }
    }
    p {
      margin: 1em 0;
    }
    a {
      color: #1a1a1a;
    }
    a:visited {
      color: #1a1a1a;
    }
    img {
      max-width: 100%;
    }
    h1, h2, h3, h4, h5, h6 {
      margin-top: 1.4em;
    }
    h5, h6 {
      font-size: 1em;
      font-style: italic;
    }
    h6 {
      font-weight: normal;
    }
    ol, ul {
      padding-left: 1.7em;
      margin-top: 1em;
    }
    li > ol, li > ul {
      margin-top: 0;
    }
    blockquote {
      margin: 1em 0 1em 1.7em;
      padding-left: 1em;
      border-left: 2px solid #e6e6e6;
      color: #606060;
    }
    code {
      font-family: Menlo, Monaco, 'Lucida Console', Consolas, monospace;
      font-size: 85%;
      margin: 0;
    }
    pre {
      margin: 1em 0;
      overflow: auto;
    }
    pre code {
      padding: 0;
      overflow: visible;
      overflow-wrap: normal;
    }
    .sourceCode {
     background-color: transparent;
     overflow: visible;
    }
    hr {
      background-color: #1a1a1a;
      border: none;
      height: 1px;
      margin: 1em 0;
    }
    table {
      margin: 1em 0;
      border-collapse: collapse;
      width: 100%;
      overflow-x: auto;
      display: block;
      font-variant-numeric: lining-nums tabular-nums;
    }
    table caption {
      margin-bottom: 0.75em;
    }
    tbody {
      margin-top: 0.5em;
      border-top: 1px solid #1a1a1a;
      border-bottom: 1px solid #1a1a1a;
    }
    th {
      border-top: 1px solid #1a1a1a;
      padding: 0.25em 0.5em 0.25em 0.5em;
    }
    td {
      padding: 0.125em 0.5em 0.25em 0.5em;
    }
    header {
      margin-bottom: 4em;
      text-align: center;
    }
    #TOC li {
      list-style: none;
    }
    #TOC ul {
      padding-left: 1.3em;
    }
    #TOC > ul {
      padding-left: 0;
    }
    #TOC a:not(:hover) {
      text-decoration: none;
    }
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1.6em;
      vertical-align: middle;
    }
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<div class="cell markdown" id="GoS-f1PZcEFN">
<p><img src="https://cloud.screenpresso.com/BiF4bZJT2saz/2024-10-03_06h25_42_original.png?_gl=1*1p2hf0x*_ga*OTY3NTc2Mjc4LjE3Mjc5Mjk1ODc.*_ga_Y5Z2778Y7J*MTcyNzkyOTU4Ny4xLjAuMTcyNzkyOTU4Ny4wLjAuMA.." width="2400"></p>
<h1
id="notebook-2-exploración-de-datos-y-fundamentos-de-imágenes-digitales"><strong>Notebook
2: Exploración de Datos y Fundamentos de Imágenes
Digitales</strong></h1>
</div>
<section
id="1-exploración-de-datos-para-el-modelo-de-diagnóstico-médico"
class="cell markdown" id="YcH9AhWnhksE">
<h2>1. Exploración de datos para el modelo de diagnóstico médico</h2>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="LOOey0n1lNKA" data-outputId="f09e97df-d9bc-48e5-fe61-69b24599642f">
<div class="sourceCode" id="cb1"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="op">!</span>git clone https:<span class="op">//</span>github.com<span class="op">/</span>CVasquezroque<span class="op">/</span>IA<span class="op">-</span>en<span class="op">-</span>salud<span class="op">-</span>INSN.git</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Cloning into &#39;IA-en-salud-INSN&#39;...
remote: Enumerating objects: 5015, done.ote: Counting objects: 100% (9/9), done.ote: Compressing objects: 100% (7/7), done.ote: Total 5015 (delta 0), reused 8 (delta 0), pack-reused 5006 (from 1)</code></pre>
</div>
</div>
<section id="11-carga-de-datos-en-python" class="cell markdown"
id="Clg4q7-QWgXN">
<h3>1.1. Carga de Datos en Python</h3>
<p>Antes de trabajar con imágenes, es esencial entender cómo cargar y
explorar datos en Python. Utilizamos bibliotecas como
<strong>pandas</strong> para cargar archivos CSV, una forma común de
almacenar datos tabulares.</p>
<p>En este ejemplo, cargaremos un archivo llamado
<code>data_ia_en_salud.csv</code> que contiene información sobre
imágenes médicas, incluidas las etiquetas de diagnóstico.</p>
</section>
<div class="cell markdown" id="F09CxjqcWti4">
<p>Podemos cargar estos datos utilizando pandas:</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:478}"
id="opKlA3dRWuxP" data-outputId="540fa246-e5f1-4892-c34a-5b9172409e8d">
<div class="sourceCode" id="cb3"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importar las bibliotecas necesarias</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar un archivo CSV en un DataFrame</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>ruta_csv <span class="op">=</span> <span class="st">&#39;/content/IA-en-salud-INSN/data_ia_salud.csv&#39;</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>datos <span class="op">=</span> pd.read_csv(ruta_csv)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;Hemos cargado </span><span class="sc">{</span>datos<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss"> filas y </span><span class="sc">{</span>datos<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> columnas&#39;</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>datos</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Hemos cargado 4999 filas y 19 columnas
</code></pre>
</div>
<div class="output execute_result" data-execution_count="2">

  <div id="df-bf345c70-c9bb-440b-a285-5701b7b901cf" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Image</th>
      <th>PatientId</th>
      <th>Patient Age</th>
      <th>Patient Gender</th>
      <th>Atelectasis</th>
      <th>Cardiomegaly</th>
      <th>Consolidation</th>
      <th>Edema</th>
      <th>Effusion</th>
      <th>Emphysema</th>
      <th>Fibrosis</th>
      <th>Hernia</th>
      <th>Infiltration</th>
      <th>Mass</th>
      <th>No Finding</th>
      <th>Nodule</th>
      <th>Pleural_Thickening</th>
      <th>Pneumonia</th>
      <th>Pneumothorax</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>00000001_000.png</td>
      <td>1</td>
      <td>57</td>
      <td>M</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>00000001_001.png</td>
      <td>1</td>
      <td>58</td>
      <td>M</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>00000001_002.png</td>
      <td>1</td>
      <td>58</td>
      <td>M</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>00000002_000.png</td>
      <td>2</td>
      <td>80</td>
      <td>M</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>00000003_001.png</td>
      <td>3</td>
      <td>74</td>
      <td>F</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>4994</th>
      <td>00001335_002.png</td>
      <td>1335</td>
      <td>18</td>
      <td>F</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4995</th>
      <td>00001335_003.png</td>
      <td>1335</td>
      <td>19</td>
      <td>F</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4996</th>
      <td>00001335_004.png</td>
      <td>1335</td>
      <td>19</td>
      <td>F</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4997</th>
      <td>00001335_005.png</td>
      <td>1335</td>
      <td>22</td>
      <td>F</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4998</th>
      <td>00001335_006.png</td>
      <td>1335</td>
      <td>23</td>
      <td>F</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>4999 rows × 19 columns</p>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-bf345c70-c9bb-440b-a285-5701b7b901cf')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-bf345c70-c9bb-440b-a285-5701b7b901cf button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-bf345c70-c9bb-440b-a285-5701b7b901cf');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


<div id="df-52d625ed-6642-412e-9bf5-4749da2e1ef7">
  <button class="colab-df-quickchart" onclick="quickchart('df-52d625ed-6642-412e-9bf5-4749da2e1ef7')"
            title="Suggest charts"
            style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
  </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

  <script>
    async function quickchart(key) {
      const quickchartButtonEl =
        document.querySelector('#' + key + ' button');
      quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
      quickchartButtonEl.classList.add('colab-df-spinner');
      try {
        const charts = await google.colab.kernel.invokeFunction(
            'suggestCharts', [key], {});
      } catch (error) {
        console.error('Error during call to suggestCharts:', error);
      }
      quickchartButtonEl.classList.remove('colab-df-spinner');
      quickchartButtonEl.classList.add('colab-df-quickchart-complete');
    }
    (() => {
      let quickchartButtonEl =
        document.querySelector('#df-52d625ed-6642-412e-9bf5-4749da2e1ef7 button');
      quickchartButtonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';
    })();
  </script>
</div>

  <div id="id_009ba270-c64f-4974-906c-18c2d52f9e3f">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('datos')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_009ba270-c64f-4974-906c-18c2d52f9e3f button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('datos');
      }
      })();
    </script>
  </div>

    </div>
  </div>

</div>
</div>
<div class="cell markdown" id="sfy7NXlNWx2g">
<p>Observa las distintas columnas en este archivo CSV. El archivo
contiene los nombres de las imágenes de rayos X de tórax (columna "Image
Index"), y las columnas llenas de unos y ceros identifican los
diagnósticos asignados a cada imagen de rayos X.</p>
</div>
<div class="cell markdown" id="uMotnPHcW4Y_">
<blockquote>
<p><strong>Pregunta</strong>: ¿Podrías identificar qué otras columnas
podrían ser útiles para un análisis exploratorio de los datos?</p>
</blockquote>
</div>
<section id="12-verificación-de-tipos-de-datos-y-valores-nulos"
class="cell markdown" id="J0VIBLXAbap3">
<h3>1.2. Verificación de Tipos de Datos y Valores Nulos</h3>
<p>Antes de continuar, es importante explorar los datos para tener una
mejor comprensión de su calidad y estructura. Ejecuta la siguiente celda
para explorar los tipos de datos presentes en cada columna y verificar
si existen valores nulos en los datos. Esto nos permitirá determinar si
necesitamos realizar algún tipo de limpieza antes de proceder.</p>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="DW8-c2RRbc5E" data-outputId="4021ea48-bf49-4438-d5c8-e33beee3f9ea">
<div class="sourceCode" id="cb5"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Verificar el tipo de dato de cada columna y si existen valores nulos</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>datos.info()</span></code></pre></div>
<div class="output stream stdout">
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 4999 entries, 0 to 4998
Data columns (total 19 columns):
 #   Column              Non-Null Count  Dtype 
---  ------              --------------  ----- 
 0   Image               4999 non-null   object
 1   PatientId           4999 non-null   int64 
 2   Patient Age         4999 non-null   int64 
 3   Patient Gender      4999 non-null   object
 4   Atelectasis         4999 non-null   int64 
 5   Cardiomegaly        4999 non-null   int64 
 6   Consolidation       4999 non-null   int64 
 7   Edema               4999 non-null   int64 
 8   Effusion            4999 non-null   int64 
 9   Emphysema           4999 non-null   int64 
 10  Fibrosis            4999 non-null   int64 
 11  Hernia              4999 non-null   int64 
 12  Infiltration        4999 non-null   int64 
 13  Mass                4999 non-null   int64 
 14  No Finding          4999 non-null   int64 
 15  Nodule              4999 non-null   int64 
 16  Pleural_Thickening  4999 non-null   int64 
 17  Pneumonia           4999 non-null   int64 
 18  Pneumothorax        4999 non-null   int64 
dtypes: int64(17), object(2)
memory usage: 742.2+ KB
</code></pre>
</div>
</div>
<section id="13-exploración-de-etiquetas-de-datos" class="cell markdown"
id="uGPytKrebivL">
<h3>1.3. Exploración de Etiquetas de Datos</h3>
<p>En esta sección, exploraremos las etiquetas de los datos. Esto es
crucial para entender la distribución de las diferentes condiciones y
asegurarnos de que tenemos una representación adecuada de cada una para
el entrenamiento del modelo.</p>
<p>Ejecuta las siguientes dos celdas para crear una lista con los
nombres de cada condición o enfermedad de los pacientes.</p>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="xGio7f_nbmds" data-outputId="d9917830-cedc-4a60-aab0-db31886e2a02">
<div class="sourceCode" id="cb7"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> datos.keys()</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>columns <span class="op">=</span> <span class="bu">list</span>(columns)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(columns)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>[&#39;Image&#39;, &#39;PatientId&#39;, &#39;Patient Age&#39;, &#39;Patient Gender&#39;, &#39;Atelectasis&#39;, &#39;Cardiomegaly&#39;, &#39;Consolidation&#39;, &#39;Edema&#39;, &#39;Effusion&#39;, &#39;Emphysema&#39;, &#39;Fibrosis&#39;, &#39;Hernia&#39;, &#39;Infiltration&#39;, &#39;Mass&#39;, &#39;No Finding&#39;, &#39;Nodule&#39;, &#39;Pleural_Thickening&#39;, &#39;Pneumonia&#39;, &#39;Pneumothorax&#39;]
</code></pre>
</div>
</div>
<div class="cell code" id="xIAEop0MboWA">
<div class="sourceCode" id="cb9"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Eliminar elementos innecesarios</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>columns.remove(<span class="st">&#39;PatientId&#39;</span>)</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>columns.remove(<span class="st">&#39;Image&#39;</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>columns.remove(<span class="st">&#39;Patient Age&#39;</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>columns.remove(<span class="st">&#39;Patient Gender&#39;</span>)</span></code></pre></div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="CMJdCExYgjU8" data-outputId="9e8d53bc-1551-4f5f-9a4b-44f1bb9e6313">
<div class="sourceCode" id="cb10"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Tenemos </span><span class="sc">{</span><span class="bu">len</span>(columns)<span class="sc">}</span><span class="ss"> columnas con los diagnósticos para estas condiciones: </span><span class="sc">{</span>columns<span class="sc">}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Tenemos 15 columnas con los diagnósticos para estas condiciones: [&#39;Atelectasis&#39;, &#39;Cardiomegaly&#39;, &#39;Consolidation&#39;, &#39;Edema&#39;, &#39;Effusion&#39;, &#39;Emphysema&#39;, &#39;Fibrosis&#39;, &#39;Hernia&#39;, &#39;Infiltration&#39;, &#39;Mass&#39;, &#39;No Finding&#39;, &#39;Nodule&#39;, &#39;Pleural_Thickening&#39;, &#39;Pneumonia&#39;, &#39;Pneumothorax&#39;]
</code></pre>
</div>
</div>
<div class="cell markdown" id="l4adAePObuDx">
<blockquote>
<p><strong>Nota</strong>: Es importante realizar este tipo de análisis
para identificar qué características serán útiles en el modelo de
aprendizaje automático y cuáles se pueden descartar.</p>
</blockquote>
</div>
<div class="cell markdown" id="FO0NdQyob3WP">
<p>Ejecuta la siguiente celda para imprimir el número de etiquetas
positivas (valores 1) para cada condición. Este análisis nos ayudará a
entender la distribución de las clases y si existe algún desbalance
significativo.</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="hhHqMc3Bb3Io" data-outputId="12bee90f-09ed-4edc-b6e5-9e872e11e338">
<div class="sourceCode" id="cb12"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Imprimir el número de etiquetas positivas para cada clase</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> column <span class="kw">in</span> columns:</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="ss">f&#39;La clase </span><span class="sc">{</span>column<span class="sc">}</span><span class="ss"> tiene </span><span class="sc">{</span>datos[column]<span class="sc">.</span><span class="bu">sum</span>()<span class="sc">}</span><span class="ss"> muestras&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>La clase Atelectasis tiene 460 muestras
La clase Cardiomegaly tiene 196 muestras
La clase Consolidation tiene 205 muestras
La clase Edema tiene 90 muestras
La clase Effusion tiene 487 muestras
La clase Emphysema tiene 125 muestras
La clase Fibrosis tiene 172 muestras
La clase Hernia tiene 27 muestras
La clase Infiltration tiene 830 muestras
La clase Mass tiene 161 muestras
La clase No Finding tiene 2754 muestras
La clase Nodule tiene 214 muestras
La clase Pleural_Thickening tiene 165 muestras
La clase Pneumonia tiene 65 muestras
La clase Pneumothorax tiene 199 muestras
</code></pre>
</div>
</div>
<section id="14-verificación-de-ids-únicos" class="cell markdown"
id="dJ_KOQAig--p">
<h3>1.4. Verificación de IDs Únicos</h3>
<p>La columna "Patient ID" tiene un número de identificación para cada
paciente. Algo importante que queremos saber sobre un conjunto de datos
médicos como este es si estamos viendo datos repetidos para ciertos
pacientes o si cada imagen representa a una persona diferente. Esto nos
ayudará a asegurarnos de que el modelo no está siendo entrenado y
probado con imágenes del mismo paciente, lo cual podría dar lugar a
<strong>fuga de datos</strong>.</p>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="OczU74tOhJAs" data-outputId="03bcbd54-cd54-43c3-8d61-2e42f61139b1">
<div class="sourceCode" id="cb14"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&#39;El total de IDs de pacientes es </span><span class="sc">{</span>datos[<span class="st">&quot;PatientId&quot;</span>]<span class="sc">.</span>count()<span class="sc">}</span><span class="ss">, de los cuales los IDs únicos son </span><span class="sc">{</span>datos[<span class="st">&quot;PatientId&quot;</span>]<span class="sc">.</span>value_counts()<span class="sc">.</span>shape[<span class="dv">0</span>]<span class="sc">}</span><span class="ss">&#39;</span>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>El total de IDs de pacientes es 4999, de los cuales los IDs únicos son 1335
</code></pre>
</div>
</div>
<div class="cell markdown" id="I64VsOvVhW_t">
<p>Como puedes ver, el número de pacientes únicos en el conjunto de
datos es menor que el número total, lo cual indica que debe haber
algunas repeticiones. Para los pacientes con múltiples registros,
deberás asegurarte de que no aparezcan en ambos conjuntos de
entrenamiento y prueba para evitar la fuga de datos (tema que se cubrirá
más adelante en las lecciones de esta semana).</p>
<blockquote>
<p><strong>Pregunta para Reflexión</strong>: ¿Qué problemas podrían
surgir si no nos aseguramos de separar adecuadamente los registros de un
mismo paciente entre el conjunto de entrenamiento y el de prueba?</p>
</blockquote>
</div>
<section id="2-fundamentos-de-imágenes-digitales" class="cell markdown"
id="I6uiBZBsh9Vd">
<h2>2. Fundamentos de Imágenes Digitales</h2>
</section>
<section id="21-estructura-de-una-imagen-digital" class="cell markdown"
id="aCL9OBL-h8mx">
<h3>2.1. Estructura de una Imagen Digital</h3>
<p>Las imágenes digitales están compuestas por <strong>píxeles</strong>,
que son la unidad más pequeña de información visual en una imagen. Cada
píxel tiene un valor que representa el color o la intensidad de la luz
en esa ubicación específica de la imagen.</p>
<ul>
<li><strong>Resolución</strong>: La resolución de una imagen se refiere
a la cantidad de píxeles que componen la imagen, normalmente expresada
como ancho x alto (por ejemplo, 1920x1080). Cuantos más píxeles tenga
una imagen, mayor será la cantidad de información visual que contendrá
y, por lo tanto, será más detallada.</li>
<li><strong>Profundidad de bits</strong>: La profundidad de bits hace
referencia a la cantidad de bits utilizados para representar el color de
cada píxel. Cuanto mayor sea la profundidad de bits, más colores pueden
ser representados. Por ejemplo, una imagen con una profundidad de 8 bits
por canal puede representar hasta 256 colores por canal.</li>
</ul>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:428}"
id="w8-xrf-BiBfA" data-outputId="83fe0b66-96ac-4765-8297-e5d98cc43074">
<div class="sourceCode" id="cb16"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importar las bibliotecas necesarias</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar una imagen en escala de grises</span></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>imagen <span class="op">=</span> cv2.imread(<span class="st">&#39;/content/IA-en-salud-INSN/nih/images/00000001_002.png&#39;</span>, cv2.IMREAD_GRAYSCALE)</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>plt.imshow(imagen, cmap<span class="op">=</span><span class="st">&#39;gray&#39;</span>)</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Imagen Original&#39;</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_c3fd75b74edb4052899eff58112335cf/dd7ef20094d305f861e16811a53bb86d88694033.png" /></p>
</div>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="SDWGGJ4NwRyK" data-outputId="0748042d-c1cb-4898-abda-2b08b8fe17e8">
<div class="sourceCode" id="cb17"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>imagen.shape</span></code></pre></div>
<div class="output execute_result" data-execution_count="12">
<pre><code>(1024, 1024)</code></pre>
</div>
</div>
<section id="22-preprocesamiento-de-imágenes-en-keras"
class="cell markdown" id="ADt70_D1i5D2">
<h3>2.2. Preprocesamiento de Imágenes en Keras</h3>
<p>Antes de entrenar un modelo, primero debes modificar tus imágenes
para que sean más adecuadas para entrenar una red neuronal
convolucional. Para esta tarea, utilizaremos la función <a
href="https://keras.io/preprocessing/image/">ImageDataGenerator</a> de
Keras para realizar el preprocesamiento y la ampliación de datos.</p>
</section>
<div class="cell code" id="SZ5vDqFXi-v-">
<div class="sourceCode" id="cb19"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Importar el generador de datos de Keras</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> tensorflow <span class="im">as</span> tf</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Normalizar imágenes</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>image_generator <span class="op">=</span> tf.keras.preprocessing.image.ImageDataGenerator(</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>    samplewise_center<span class="op">=</span><span class="va">True</span>, <span class="co"># Establecer la media de cada muestra a 0.</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>    samplewise_std_normalization<span class="op">=</span><span class="va">True</span> <span class="co"># Dividir cada entrada por su desviación estándar</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
</div>
<section id="estandarización" class="cell markdown" id="VFXOupKCj6kk">
<h4><strong>Estandarización</strong></h4>
<p>El <code>image_generator</code> que creaste anteriormente ajustará
los datos de imagen de tal manera que la nueva media de los datos será
cero y la desviación estándar será 1.</p>
<p>En otras palabras, el generador reemplazará cada valor de píxel en la
imagen por un nuevo valor calculado restando la media y dividiendo por
la desviación estándar.</p>
<p><span class="math display">$$
\frac{x_i - \mu}{\sigma}
$$</span></p>
<p>Ejecuta la siguiente celda para preprocesar tus datos utilizando el
<code>image_generator</code>. En este paso también reducirás el tamaño
de la imagen a 320x320 píxeles.</p>
</section>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;}"
id="VVr4hr2-j97q" data-outputId="12362e5e-c5a0-4507-ab85-81855ebb856a">
<div class="sourceCode" id="cb20"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Flujo desde el directorio con tamaño de lote y tamaño de imagen objetivo especificados</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>generator <span class="op">=</span> image_generator.flow_from_dataframe(</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>        dataframe<span class="op">=</span>datos,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>        directory<span class="op">=</span><span class="st">&quot;/content/IA-en-salud-INSN/nih/images/&quot;</span>,</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>        x_col<span class="op">=</span><span class="st">&quot;Image&quot;</span>, <span class="co"># características</span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>        y_col<span class="op">=</span>[<span class="st">&#39;Fibrosis&#39;</span>], <span class="co"># etiquetas</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>        class_mode<span class="op">=</span><span class="st">&quot;raw&quot;</span>, <span class="co"># &#39;Fibrosis&#39; debería estar en el DataFrame</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>        batch_size<span class="op">=</span><span class="dv">1</span>, <span class="co"># imágenes por lote</span></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>        shuffle<span class="op">=</span><span class="va">False</span>, <span class="co"># barajar las filas o no</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>        target_size<span class="op">=</span>(<span class="dv">320</span>, <span class="dv">320</span>) <span class="co"># ancho y alto de la imagen de salida</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>)</span></code></pre></div>
<div class="output stream stdout">
<pre><code>Found 4999 validated image filenames.
</code></pre>
</div>
</div>
<div class="cell markdown" id="oQ1wsZ4Lmfkg">
<p>Ejecute la siguiente celda para trazar un ejemplo de una imagen
preprocesada</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:521}"
id="faaIFxwZmhb-" data-outputId="167a11cd-79eb-4f90-c772-7a1e88a78390">
<div class="sourceCode" id="cb22"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>generated_image, label <span class="op">=</span> generator.<span class="fu">__getitem__</span>(<span class="dv">0</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>plt.imshow(generated_image[<span class="dv">0</span>], cmap<span class="op">=</span><span class="st">&#39;gray&#39;</span>)</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Raw Chest X Ray Image&#39;</span>)</span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;Las dimensiones de la imagen son </span><span class="sc">{</span>generated_image<span class="sc">.</span>shape[<span class="dv">1</span>]<span class="sc">}</span><span class="ss"> pixeles de ancho y </span><span class="sc">{</span>generated_image<span class="sc">.</span>shape[<span class="dv">2</span>]<span class="sc">}</span><span class="ss"> pixeles de alto&quot;</span>)</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;El valor máximo de píxel es </span><span class="sc">{</span>generated_image<span class="sc">.</span><span class="bu">max</span>()<span class="sc">:.4f}</span><span class="ss"> y el mínimo es </span><span class="sc">{</span>generated_image<span class="sc">.</span><span class="bu">min</span>()<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="ss">f&quot;El valor medio de los píxeles es </span><span class="sc">{</span>generated_image<span class="sc">.</span>mean()<span class="sc">:.4f}</span><span class="ss"> y la desviación estándar es </span><span class="sc">{</span>generated_image<span class="sc">.</span>std()<span class="sc">:.4f}</span><span class="ss">&quot;</span>)</span></code></pre></div>
<div class="output stream stderr">
<pre><code>WARNING:matplotlib.image:Clipping input data to the valid range for imshow with RGB data ([0..1] for floats or [0..255] for integers).
</code></pre>
</div>
<div class="output stream stdout">
<pre><code>Las dimensiones de la imagen son 320 pixeles de ancho y 320 pixeles de alto
El valor máximo de píxel es 1.8811 y el mínimo es -1.9009
El valor medio de los píxeles es 0.0000 y la desviación estándar es 1.0000
</code></pre>
</div>
<div class="output display_data">
<p><img
src="vertopal_c3fd75b74edb4052899eff58112335cf/ab11862cc09afb3c93ca02340bccf44f655259f1.png" /></p>
</div>
</div>
<section id="23-filtros-y-kernels-en-procesamiento-de-imágenes"
class="cell markdown" id="el_Mg_c0nBZN">
<h3>2.3. Filtros y Kernels en Procesamiento de Imágenes</h3>
<p>Las imágenes digitales se pueden transformar mediante la aplicación
de <strong>filtros</strong>, los cuales utilizan
<strong>kernels</strong> para modificar los valores de los píxeles y
resaltar características específicas. Un <strong>kernel</strong> es una
pequeña matriz (por ejemplo, 3x3 o 5x5) que se aplica sobre la imagen
para modificar los valores de los píxeles según un criterio específico.
Cada valor del kernel se multiplica por el valor del píxel y sus
vecinos, y la suma de estos productos se convierte en el nuevo valor del
píxel central.</p>
<p>Por ejemplo, consideremos un kernel de 3x3 para detección de
bordes:</p>
<p>\begin{bmatrix} 1 &amp; 0 &amp; -1 \ 1 &amp; 0 &amp; -1 \ 1 &amp; 0
&amp; -1 \end{bmatrix}</p>
</section>
<div class="cell markdown" id="WahpvEWfnCn8">
<p>Este kernel ayuda a resaltar los bordes verticales de una imagen.</p>
</div>
<div class="cell markdown" id="1V8Ks1mznE2w">
<p>Vamos a implementar algunos kernels simples y aplicar estos filtros
manualmente para comprender cómo funcionan antes de utilizar las
funciones ya definidas en OpenCV.</p>
<p>Primero, veamos un ejemplo donde aplicamos un kernel manualmente
usando la función <code>cv2.filter2D()</code>.</p>
</div>
<div class="cell markdown" id="jjBvFxtfnGcF">
<p><strong>¿Qué es <code>cv2.filter2D()</code>?</strong></p>
<p>La función <code>cv2.filter2D()</code> es una herramienta de OpenCV
que nos permite aplicar un <strong>filtro</strong> (en este caso, un
kernel) a una imagen. Esta función realiza una
<strong>convolución</strong> entre la imagen y el kernel, generando una
nueva imagen donde se han resaltado ciertas características según el
kernel utilizado.</p>
<p>Veamos los parámetros que usamos en <code>filter2D()</code>:</p>
<ul>
<li><strong><code>src</code></strong>: La imagen de entrada sobre la
cual se aplicará el filtro.</li>
<li><strong><code>ddepth</code></strong>: La profundidad de la imagen de
salida. Usualmente usamos <code>-1</code> para mantener la misma
profundidad que la imagen original.</li>
<li><strong><code>kernel</code></strong>: El kernel que definimos, una
pequeña matriz que indicará cómo modificar los píxeles de la
imagen.</li>
</ul>
</div>
<div class="cell markdown" id="GZj1LH_lnJop">
<p>Veamos cómo se aplica:</p>
</div>
<div class="cell code"
data-colab="{&quot;base_uri&quot;:&quot;https://localhost:8080/&quot;,&quot;height&quot;:411}"
id="gfMgH0WsnLMf" data-outputId="decae7fb-e76d-405d-b8d8-270a52ea35a3">
<div class="sourceCode" id="cb25"><pre
class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> cv2</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Cargar la imagen en escala de grises</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>imagen <span class="op">=</span> cv2.imread(<span class="st">&#39;/content/IA-en-salud-INSN/nih/images/00000013_002.png&#39;</span>, cv2.IMREAD_GRAYSCALE)</span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Definir un kernel de detección de bordes verticales</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>kernel_bordes <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>                          [<span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>],</span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>                          [<span class="dv">1</span>, <span class="dv">0</span>, <span class="op">-</span><span class="dv">1</span>]])</span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Aplicar el kernel usando la función de convolución de OpenCV</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>imagen_bordes <span class="op">=</span> cv2.filter2D(src<span class="op">=</span>imagen, ddepth<span class="op">=-</span><span class="dv">1</span>, kernel<span class="op">=</span>kernel_bordes)</span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Mostrar la imagen original y la imagen con bordes detectados</span></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">5</span>))</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">1</span>)</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>plt.imshow(imagen, cmap<span class="op">=</span><span class="st">&#39;gray&#39;</span>)</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Imagen Original&#39;</span>)</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>)</span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a>plt.imshow(imagen_bordes, cmap<span class="op">=</span><span class="st">&#39;gray&#39;</span>)</span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Detección de Bordes Verticales&#39;</span>)</span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>plt.axis(<span class="st">&#39;off&#39;</span>)</span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="output display_data">
<p><img
src="vertopal_c3fd75b74edb4052899eff58112335cf/95a4abe79dc37a249a18bf7de9c708d6685bcafa.png" /></p>
</div>
</div>
<div class="cell markdown" id="IjiZJ9cVnz1f">
<p>En este ejemplo, utilizamos <code>cv2.filter2D()</code> para aplicar
el <strong>kernel de detección de bordes verticales</strong>. Este
kernel resalta las áreas donde hay un cambio significativo en los
valores de píxeles en la dirección vertical, ayudándonos a visualizar
los bordes verticales de los objetos en la imagen.</p>
</div>
<div class="cell markdown" id="UIvZnhMxn17y">
<blockquote>
<p><strong>Tarea</strong>: Cambia los valores del kernel y observa cómo
afectan el resultado. Intenta diseñar un kernel que detecte bordes
horizontales.</p>
</blockquote>
</div>
<section id="relación-con-opencv-y-mapas-de-características"
class="cell markdown" id="ivEfI59KWXY0">
<h3>Relación con OpenCV y Mapas de Características</h3>
<p>Los filtros que podemos implementar manualmente tienen equivalentes
en OpenCV, como <code>cv2.Canny()</code>, entre otros. Sin embargo, es
importante entender que detrás de cada una de estas funciones hay una
operación con un kernel que altera los valores de los píxeles de la
imagen para obtener un resultado deseado.</p>
<p>En una red neuronal convolucional (CNN), muchos de estos
<strong>kernels</strong> son aprendidos automáticamente durante el
proceso de entrenamiento. Estos kernels, aplicados a las imágenes,
generan <strong>mapas de características</strong> que resaltan
diferentes aspectos, como bordes, texturas, o patrones más
complejos.</p>
<p>Cada <strong>mapa de características</strong> es el resultado de
aplicar un kernel específico a la imagen de entrada. Al tener varios
mapas de características, la CNN puede entender la imagen de una manera
más detallada y aprender patrones complejos que son útiles para tareas
como clasificación o detección de objetos.</p>
<blockquote>
<p>La <strong>convolución</strong> es un proceso matemático en el que un
kernel se desliza sobre la imagen y se calcula la suma ponderada de los
píxeles dentro del área cubierta por el kernel. Esta operación nos
permite resaltar ciertas características de la imagen.</p>
</blockquote>
</section>
<div class="cell markdown" id="o-KczSFjpYCR">
<p><img src="https://www.semiconductorforu.com/wp-content/uploads/2018/12/A-CNN-breaks-an-image-into-feature-maps.jpg" width="2400"></p>
</div>
</body>
</html>
